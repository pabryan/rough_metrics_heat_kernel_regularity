\documentclass[a4paper, 12pt]{amsart}
%\usepackage{showkeys}

\input{StandardPaper2.tex}
\input{local_definitions.tex}

\newcommand{\Bk}{\color{black}}
\newcommand{\Pu}{\color{purple}}
\newcommand{\Rd}{\color{red}}
\newcommand{\Bl}{\color{blue}}


\begin{document}

\title{Heat kernels and regularity for rough metrics}

\author{Lashi Bandara}
\author{Paul Bryan}

\curraddr{}
\email{}
\date{\today}

\dedicatory{}
\subjclass[2010]{}
\keywords{}

\parindent0cm
\setlength{\parskip}{\baselineskip}


\begin{abstract}
We consider smooth manifolds equipped with rough metrics
we demonstrate the existence of globally continuous
heat kernels that are locally Hölder. This is done 
by employing local Harnack estimate for weak
solutions of divergence form elliptic equations
with bounded measurable coefficients in weighted Sobolev
spaces.
\end{abstract}

\maketitle

\section{Introduction}
\label{sec:intro}
The existence and regularity of heat kernels on smooth manifolds, with smooth (or even continuous)
metrics is now a classical fact. However, there has been
little in the way of investigation
of this topic for metrics beneath continuous coefficients. 

A wide and useful class of potentially discontinuous metrics are called \emph{rough metrics}, 
which by definition, have only measurable coefficients, and are Riemannian-like in the sense
that they are locally comparable almost-everywhere to a smooth Riemannian metric (see \Cref{defn:rough_metric}).
These metrics became of interest as geometric invariances of the Kato square
root problem, particularly in the non-compact setting, in \cite{BMc, BRough}. 
In the compact case, these metrics were used to study regularity properties
of a geometric flow, weakly tangential to the Ricci flow, 
in \cite{BLM, BCont}. 

Rough metrics, like their classical continuous
or smooth counterparts, induce a canonical volume form \(\omega_g\) via the Hodge star operator \(\ast = \ast_g\) acting on differential forms with measureable coefficients: \(\omega_g = *1\). The corresponding measure \(\omega_g(E) = \int_E d\omega_g\) is positive Radon measure given locally by the expression $d\omega(x) = \sqrt{\det g(x)} dx^1 \wedge \cdots \wedge dx^n$. Thus we may define \(\Lp{p}\) spaces of functions, and more generally \(\Lp{p}\) spaces of sections of tensor bundles.

Since the underlying manifolds we consider are smooth (topologically), the exterior derivative of \(C^{\infty}\) differential forms is defined, and is closable in $\Lp{2}(M)$, allowing us to construct the Sobolev spaces $\SobH{1}(M)$
and $\SobH[0]{1}(M)$. The
former space is the  energy for the Neumann Laplacian
and the latter for the Dirichlet counterpart.
With respect to these Laplacians, we can now ask
whether a heat kernel exists, and how regular one
can expect such an object to be. In the setting of rough metrics, our main theorem
is the following. 

\begin{thm}
On a smooth manifold \(M\), equipped with a rough metric \(g\), there exists a 
Dirichlet heat kernel \(\hk_t^g = \hk_t\), such that
\begin{enumerate}
\item \(\hk_t > 0\) for \(t > 0\),
\item on a parabolic cylinder \(Q = K \times [t_1, t_2]\) with \(0 < t_1 < t_2\), \(K \subseteq M\) is compact, there exists an \(\alpha = \alpha(Q)\) so that \(\hk_t^g \in C^{\alpha}(K \times K)\) for \(t_1 \leq t \leq t_2\).
\end{enumerate}
\end{thm}


Note that heat kernels have been considered
for some time in more general settings than smooth Riemannian manifolds,
with the bulk of the literature focusing on metric spaces with bounds
on certain synthetic notions of curvature.
Many classical results can be recovered from this general 
theory since smooth (or continuous) metrics induce an associated intrinsic
distance structure. A priori, there is no reason
why a rough metric should induce a canonical distance structure - at least
this cannot be done via minimisation over curves since the
length functional may not be a well-defined device. 

The significance of our results in this paper is to demonstrate
the construction of heat kernels in this setting where we may 
not have a canonical distance but instead, we have well-defined Laplacians. 
Unlike in many classical treatments which construct the \emph{minimal} 
heat kernel via local-to-global methods, our construction is purely global.
It is likely that in many instances we are sacrificing minimality but if we fix
an energy space, we are obtaining an object that is unique to that energy.

The former set of methods typically yield a so-called minimal heat kernel,
but additional assumptions, such as a lower bound on Ricci curvature,
is assumed in order to obtain its uniqueness (see \cite{Chavel}).
More seriously, the following Varadahn's formula
$$ d^2(x,y) = 4 \lim_{t \to 0} t \log \hk_t(x,y)$$
may fail for this minimal heat kernel. In the smooth setting, it is well known that Varadahn's formula holds for the heat kernel corresponding to Dirichlet Laplacian (i.e., with energy in $\SobH[0]{1}(M)$).

This formula is a strong motivating factor for our paper: 
in the rough setting, we do not have a canonical notion of
distance, but given that we have a canonical Laplacian, 
any distance we may attempt to construct for a rough 
metric should at least allow us to establish this formula.  A study of the distance structure associated to a rough metric will be taken up elsewhere.


The method of constructing the global heat kernel
via Riesz representation methods is made known to us by
the book of Davies in \cite{Davies}.
In \cite{BCont} where the manifold was assumed to be compact, 
the existence and regularity of the heat kernel was
reduced to \emph{Harnack estimates}, which were
furnished by observing that  
the rough metric was globally comparable to a smooth metric
due to the compactness of the underlying manifold and
through the  results of Sallof-Coste in \cite{SC}.
In our situation, these results do not apply without additional assumptions
and so instead, we demonstrate
how to obtain the heat kernel via \emph{local Harnack estimates}. 

\section*{Acknowledgements}

Kaj Nyström, KAW, Warwick, Monash, Lashi's parents, UQ and Joe Grotowski, Orbost hotel?

\section{Rough Metrics}
\label{sec:rough_metrics}

The term ``rough metric'' was coined in \cite{BRough} as they were 
recognised to be the geometric invariances of the Kato square root problem.
We emphasise here that similar notions existed implicitly in the 
literature with the work of Norris in \cite{Norris} 
and \cite{SC} by Saloff-Coste.
We recall the most impoartant aspects of rough metrics here. A more detailed exposition is available in section 3 in \cite{BRough}.

We begin with the following definition, which recognises
that a manifold affords us not only with a metric independent 
topology and differentiable structure, but also a metric independent measure
structure.

\begin{defn}
\label{defn:borel_lebesgue}
Let \(M^n\) be a smooth, \(n\)-dimensional manifold. A set \(B \subseteq M\) is a \emph{Borel set} if for all charts \(\varphi : U \subseteq M \to V \subseteq \R^n\), the set \(\varphi(B \cap U) \subseteq \R^n\) is a Borel set. A set \(E \subseteq M\) is said to be \emph{Lebesgue measurable} if \(\varphi(E \cap U)\) is a Lebesgue measurable set of \(\R^n\).
\end{defn}

\begin{rem}
The Lebesgue measurable sets form a \(\sigma\)-algebra containing the Borel \(\sigma\)-algebra. The notion of Lebesgue measurable set does not involve a measure on \(M\) and is canonical in the following sense: a volume form, \(\omega\) on \(M\) is a measureable section of the bundle \(\Omega^n(M)\) of top differential forms. Such an \(\omega\) defines a signed, (outer) measure \(E \mapsto \int_E\ d\omega\) for which the \(\sigma\)-algebra of measurable sets is precisely the \(\sigma\)-algebra of Lebesgue measurable sets. This follows by observing that with respect to any chart, \(\omega\) is absolutely continuous with respect to the pull-back of the Lebesgue measure in the chart. That is, \(\omega = \rho dx^1 \wedge \cdots \wedge dx^n\) is absolutely continuous with respect to the local Lebesgue measure \(dx^1 \wedge \cdots \wedge dx^n\).
\end{rem}

We may now define the notion of measurable functions and sections of smooth vector bundles.

\begin{defn}[Measurable functions and sections]
A function $f: M \to \R$ is measurable if $f^{-1}(-\infty, \alpha]$ is measurable for every $\alpha  \in \R$. A measurable section \(s\) of a vector bundle \(\pi : V \to M\) is a function \(s: M \to V\) with \(\pi \circ s = \Id_M\) and such that for any Lebesgue measurable subset \(E \subseteq V\), the set \(s^{-1}(E)\) is a Lebesgue measurable subset of \(M\).  We denote the set of such sections by $\Gamma(V)$.
\end{defn}

Note that \(V\) is a smooth manifold itself and so Lebesgue Measurability of subsets of \(V\) is defined as in \ref{defn:borel_lebesgue}. In particular, we have the bundle $\pi_{p,q} : T^{p,q}M \to M$ of $(p,q)$ tensors of covariant rank $p$ and contravariant rank $q$ as well as measurable tensor fields \(\Gamma(T^{p,q}M\). We also have the bundle of differential forms \(\pi_k : \Lambda^k T^{\ast} M \to M\) with measurable sections \(\Omega^k(M) = \Gamma(\Lambda^k T^{\ast} M)\). The exterior derivative is however, \emph{not defined} for all measurable sections. All the usual constructions of smooth sub-vector and sub-fibre bundles apply and in particular, we have a well defined notion of measurable sections of the fibre bundle, \((T^{\ast} M \odot T^{\ast} M)_+\) of positive definite, symmetric bilinear forms important in the main definition of this section:

\begin{defn}[Rough metric]
\label{defn:rough_metric}
A \emph{rough} metric \(g\) is a Lebesgue measurable section of \(\met(M) = (T^{\ast} M \odot T^{\ast} M)_+\), the bundle of positive definite, symmetric bilinear forms on \(TM\) that are in addition, \emph{locally comparable} to Euclidean metrics:
for each $x \in M$, there is a chart $\psi_x:V_x \to \R^n$ and a constant $C_x = C_x(V_x)$ such that
\[
\frac{1}{C_{x}} \pullb{\psi_x}\delta_{\R^n}(y) (X, Y) \leq g(y)(X, Y) \leq C_{x} \pullb{\psi_x}\delta_{\R^n}(y) (X, Y)
\]
for all tangent vectors \(X, Y \in T_yM\) for almost all $y \in V_x$. Equivalently, there is an open cover \(\lbrace U_{\alpha} \rbrace\) of \(M\), smooth metrics \(g_{\alpha} \in \met(U_{\alpha})\) and real constants \(C_{\alpha} > 0\) such that
\[
\frac{1}{C_{\alpha}} g_{\alpha} (X, Y) \leq g(X, Y) \leq C_{\alpha} g_{\alpha} (X, Y)
\]
for all tangent vectors \(X, Y \in T_yM\) for almost every $y \in U_\alpha$.
\end{defn}

\begin{rem}
By employing a partition of unity argument, we can patch together the metrics \(g_{\alpha}\) to produce a globally defined, smooth metric \(h\). If the constants \(C_{\alpha}\) are uniformly bounded above and away from zero, then our rough metric will be globally comparable to \(h\). This is automatic whenever \(M\) is compact. If \(M\) is not compact, then this need not be true. In the globally comparable case where the metric \(h\) has bounded below sectional curvature, a Harnack inequality and heat kernel estimates have been obtained with uniform constants \cite{SC}. Here we do not require the assumptions of global comparability and as a result our constants are not uniform.
\end{rem}

Given a rough metric, we may locally define a \(g_{\alpha}\)-self-adjoint, measurable section \(A_{\alpha} : U_{\alpha} \to T^{1,1}U_{\alpha}\) by
\[
g(X, Y) = g_{\alpha} (A_{\alpha} (X), Y).
\]
Such a definition has the advantage that it allows us to work with respect to the \emph{smooth} metric \(g_{\alpha}\).

A rough metric gives rise to an $\Lp{p}$-theory over the $T^{p,q}M$ tensor bundle by defining \(L^p\) norms,
\[
\|\xi\|_p := \left(\int_{M} |\xi|_{g}^p\ d\omega_g\right)^{1/p}
\]
for $p \in [1, \infty)$ and
\[
\|\xi\|_{\infty} := \inf\set{C: |\xi|_g \leq C\ \text{a.e.}}
\]
where the rough metric \(g\) is extended to tensor bundles exactly as in the smooth case. For example, \(g(X \otimes Y, Z \otimes W) = g(X, Y) g(Z, W)\) gives a well defined, measurable section of positive definite, symmetric bilinear forms on \(TM \otimes TM\).

Lastly, let us note that all function spaces we consider are complex-valued function spaces, which are obtained from the real setting by complexification.


\section{Laplacians and Heat Equation for rough metrics}


For a smooth function \(f \in \Ck{\infty}(M)\), write \(\nabla f = df\) for the differential of \(f\). 
The differential \(\nabla : \Ck{\infty}(M) \to \Ck{\infty}(T^{\ast} M)\), maps smooth functions 
\(\Ck{\infty}(M)\) to smooth one-forms \(\Ck{\infty}(T^{\ast} M)\). 
We emphasise that this object is only dependent on the differentiable structure of $M$, and is independent of any choice of metric.

Recall that in the classical setting of a smooth $g$,  the Laplacian acting on functions is given  via the expression $\Delta_g = - \tr_g \nabla^2$, where $\nabla^2 = \nabla^{T^\ast M} \comp \nabla$
with $\nabla^{T^\ast M}$ the Levi-Civita connection of $g$ on \(T^{\ast} M\) and the trace is taken on the \((1,1)\) hessian obtained by metric contraction of the \((2, 0)\) hessian \(\nabla^2\). Metric compatability allows one to commute the trace with \(\nabla\) to obtain equivalently that \(\Delta_g = \dive \grad_g\) where \(\grad_g\) is the metric contraction of \(\nabla\).

For rough metrics, or even for a continuous metric, we have no notion of metric-compatability (begin unable to differentiate such a metric), and hence the Levi-Civita connection is not generally defined. Therefore, we understand this operator in an appropriate weak sense as follows:

First, we observe that for a rough metric $g$, the operator
$\nabla_p := d_p: \Ck{\infty} \cap \Lp{p}(M) \to \Ck{\infty} \cap \Lp{p}(T^\ast M)$
is closable, as well as $\nabla_c := d_c$ with $\dom(d_c) = \Ck[c]{\infty}(M)$,
for $p \in [1, \infty)$. A proof of this statement is given in Proposition 3.10 in \cite{BRough}, 
which reduces to covering the manifold via precompact locally comparable
charts and noting that $d$ commutes with pullbacks inside each such chart.

Consequently, we can define first-order Sobolev spaces
\[
\Sob[0]{1,p}(M) := \dom(\overline{\nabla_c})\quad \text{and}\quad  \Sob{1,p}(M) := \dom(\overline{\nabla_p}),
\]
where the closures are taken with respect to the \(\Lp{p}(M)\) norm. We may then define Sobolev norms
\[
\|u\|_{\Sob{p}} = \|u\|_p + \|\nabla u\|_p
\]
which are finite on the respective function spaces $\Sob[0]{1,p}(M) \subset \Sob{1,p}(M) \subset \Lp{p}(M)$. We remark that without closability, if these spaces were obtained via a completion with respect to the Sobolev norm, we could not assert that they were spaces of functions. In this paper, we exclusively with \(p = 2\).

Another consequence of the closability, coupled with the 
fact that $\Ck[c]{\infty}(M)$ are dense in $\Lp{2}(M)$ 
is that $\nabla_2$ and $\nabla_c$ are densely-defined
operators. Therefore, operator theory yields 
that $\adj{\nabla_2}$ and $\adj{\nabla_c}$ exist
as densely-defined, closed operators.

\subsection{The Laplacian in the smooth setting}

In the case of a smooth $g$ that is also complete, we
always have that $\SobH[0]{1}(M) = \SobH{1}(M)$. 
Then, since $\nabla_c = \nabla_2$, we obtain 
a unique Laplacian $\Delta_g = \adj{\nabla_c} \close{\nabla_c} = \adj{\nabla_2}\close{\nabla_2}$.
We will emphasise at this moment that even in the smooth case, this does not mean that the Laplacian is essentially self-adjoint on $\Ck[c]{\infty}(M)$; in fact, the only general statement that can be made is that
$\SobH{2}(M) \subset \dom(\Delta_g)$. The 
case of essential self-adjointness can
be obtained under a uniform lower bound on Ricci
curvature (see \cite{BDensity}) but it
is not known to the authors whether this condition is sharp.

It is also useful to obtain $\Delta_g$ via the energy,
$$\sE_g(u,v) = \inprod{\nabla u, \nabla v} = \int_M\ g(\nabla u, \nabla v)\ d\omega_g,$$
where $\dom(\sE_g) = \SobH[0]{1}(M) = \SobH{1}(M)$.
The operator $\Delta_g$ is now obtained via the Riesz representation theorem or the Lax-Milgram theorem in the case \(\nabla\) is not essentially self-adjoint.

Note that in our setup, $\nabla$ is independent of the geometry (i.e. the metric), but the energy is of course dependent on the geometry. At the operator level, it is in taking the adjoint $\adj{\nabla}$ where the geometry becomes of consequence. Alternatively, defining the gradient, $\grad u =  (\nabla u)^\sharp = g(\nabla u, \cdot)$, we then have by definition, $\sE_g(u,v) = \inprod{\grad u, \grad v}$. In this case, we have in fact $\Delta_g = \adj{\grad} \close{\grad}$, and so we could equivalently define \(\Delta\) via \(\grad\). We prefer the former picture for the simple fact that in the latter picture, the metric information and topological information are intertwined whereas in our case we have two operators in which one which only depends on the differential structure and the other on the geometry $g$.

When $g$ fails to be complete, it may be that  
$\SobH[0]{1}(M) \subsetneqq  \SobH{1}(M)$.
In that case, we obtain a \emph{Dirichlet Laplacian} and  a \emph{Neumann 
Laplacian} corresponding to which space we pick 
to consider the associated energy.
We retain this language from the world of boundary 
value problems because there, when $M = \interior\Omega$
for a bounded domain $\Omega$ (say with Lipschitz boundary), we have that
$\SobH[0]{1}(M)$ defines the energy for
the Laplacian considered in the Dirichlet problem
and $\SobH{1}(M)$ defines the energy 
for the Laplacian considered for the Neumann problem.

\subsection{The Laplacian in the rough setting}

In our approach, valid also in the smooth setting, we proceed slightly more generally. Inspired by the classical setting, we define
the following.
 
\begin{defn}[$(g,\cW)$-Laplacian]
Let \(g\) be a rough metric on a smooth manifold \(M\)
and $\cW \subset \SobH{1}(M)$ be a closed subspace
of $\SobH{1}(M)$ such that $\Ck[c]{\infty}(M) \subset \cW$
and $\Ck{\infty} \cup \cW$ is dense in $\cW$ with respect to the norm $\norm{\cdot}_{\cW} = \norm{\cdot}_{\SobH{1}}$. The \emph{$(g,\cW)$-Laplacian}
\(\Delta_{g,\cW} : \Lp{2}(M) \to \Lp{2}(M)\) is defined by
\[
\Delta_{g,\cW} u := \adj{\nabla_{\cW}} \close{ \nabla_{\cW}} u,
\]
where  $\nabla_{\cW} = \nabla$ with $\dom(\nabla_{\cW}) = \cW$. 
The domain of the operator $\Delta_{g,\cW}$ is then given by
$$\dom(\Delta_{g,\cW}) = \set{u \in \SobH[0]{1}(M): \modulus{\inprod{\nabla u, \nabla v}} \lesssim C_u \norm{v}\ \forall v \in \SobH[0]{1}(M)}.$$
\end{defn}

By construction, the  operators $\Delta_{g,\cW}$ 
are densely-defined, closed, self-adjoint and satisfy 
$\dom(\sqrt{\Delta_{g,\cW}}) = \cW$.
It is difficult to see how to obtain this from the expression for $\Delta_{g,D}$.
Rather, this operator is constructed via the Riesz representation
theorem (or the theorem of Lax-Milgram) by considering the
energy $\sE_{g,\cW}(u,v) = \inprod{\nabla u, \nabla v}$ 
with $\dom(\sE_{g,\cW}) = \cW$ written exactly as we did for the smooth case.
These are routine facts from operator theory in far more general 
settings than what we consider here. See for instance 
\cite{Yosida, Kato}.

Let us remark on why we work with the spaces \(\cW\). First, observe that the case of $\cW = \SobH[0]{1}(M)$
yields the Dirichlet Laplacian
and $\cW = \SobH{1}(M)$ yields the Neumann counterpart.
However, beyond these two obvious choices, 
there are many interesting spaces $\cW$ that
can be considered. These are best
seen emerging from boundary value problems.
As a guiding example, let $\Omega \subset \R^n$
be a smooth (or Lipschitz) bounded domain, and let $\Sigma \subset \partial \Omega$
be an open subset of the boundary $\partial \Omega$.
On letting $\Tr: \SobH{1}(\Omega) \to \SobH{\frac{1}{2}}(\partial \Omega)$
be the trace map to the boundary, define 
$\cW_{\Sigma} = \set{u \in \SobH{1}(\Omega): \spt (\Tr u) \subset \close{\Sigma}}$. 
It is clear that $\Ck[c]{\infty}(\Omega) \subset \cW_{\Sigma}$ and
it can be shown that $\cW_{\Sigma} \subset \SobH{1}(\Omega)$
is a closed subset. 
The interpretation here is that $\Sigma$ specifies Neumann boundary conditions whereas $\Omega \setminus \Sigma$
specifies Dirichlet boundary conditions. Therefore
these are mixed boundary value problems as considered
by  Axelsson (Rosén), Keith and McIntosh in \cite{AKM2}.

\subsection{The Heat Equation}

Now, we proceed to define what we mean by a solution to the heat
equation, which becomes the central theme of what is to follow.

\begin{defn}[Solution to the heat equation]
A function \(u \in \Ck{1}((0,\infty),  \dom(\Delta_{g,\cW}))\) solves the \emph{\(\cW\)-heat equation} (or just heat equation for short) with initial condition $u_0 \in \Lp{2}(M)$ if we have that
\begin{enumerate}[(i)]
\item  $\partial_t u (\cdot, t) = \Delta_{g,\cW} u(\cdot, t)$ for $t \in (0, \infty)$ and 
\item $\lim_{t \to 0} u(\cdot, t) = u_0$ in $\Lp{2}(M)$.
\end{enumerate}
\end{defn}

For any solution \(u\), of the heat equation, we have the representation formula
\[
u(x,t) = (e^{-t \Delta_{g,\cW}}u_0)(x)
\]
for almost every $x \in M$.
 
\begin{rem}
In the compact case with a smooth metric, a solution is often formulated to mean $u \in \Ck{\infty}( M \times (0, \infty))$
with $\partial_t u(x,t) = \Delta u(x,t)$ with 
$\lim_{t \to 0} u(x,t) = u_0 \in \Ck[c]{\infty}(M)$.
In this case, $\Delta_{g,\cW} = \Delta_{g,\theta}$ is independent
of $s$ and moreover, since $\Ck{\infty}(M) \subset \Lp{2}(M)$
this notion of solution is stronger than our notion of solution.
\end{rem}

\section{Existence and positivity of the heat kernel}

\begin{defn}[Heat kernel]
A measurable symmetric map $\hk^{g,\cW}_{\mdot}: \R_+ \times M \times M \to \R$ is a heat kernel if for every $u \in \Ck{1}(\R_+, \cW)$, a solution to the Dirichlet heat equation $\partial_t u = \Delta_{g,\cW}$ with initial data $u_0 \in \Lp{2}(M)$, we have
\[
u(t,x) = \int_{M} \hk^{g,\cW}_t(x,y) u_0(y)\ d\omega_g(y)
\]
and
$\lim_{t \to 0} \hk_t^{g,\cW}(\mdot,y) \to \delta(y)$ in the sense of distributions where $\delta(y)$ is the Dirac-delta distribution.
\end{defn}

In the case of a smooth metric $g$, a typical construction for
the heat kernel is to construct the so-called \emph{minimal} heat kernel.
This is done by taking smooth domains $\Omega_j$, 
each of which are precompact and satisfying $\close{\Omega_j} \subset \Omega_{j+1}$. 
Inside each domain, one can solve the Dirichlet problem
to obtain heat kernels $\hk^{g,j}_{t}$, each of which
satisfies 
$$ \int_{M} \hk^{g,j}(x,y)\ d\omega_g(y) < 1.$$
Then, one can make sense of the limit $\lim_{j \to \infty} \hk^{g,j}(x,y)$
in the compact-open topology to obtain a heat kernel $\hk^{\min}_t$.
See Chapter VIII in \cite{Chavel} for the details
of this construction.

We refrain from considering this approach in the rough setting 
for the reason that this object may fail to be unique (uniqueness
is known for smooth complete $g$ with 
uniform lower bounds on Ricci curvature) and more seriously, the following
Varadhan's asymptotics may fail: 
$d^2(x,y) = \lim_{t \to 0} 4t \log \hk^{\min}_t(x,y)$,
which is a motivating factor for this paper as mentioned in the 
introduction.

Consequently, we can instead consider heat kernels
associated to the operator $\Delta_{g,\cW}$ in $\Lp{2}$
via the Riesz representation theorem as described in Theorem 
5.2.1 in \cite{Davies}. As aforementioned, in the smooth case,
at least for the heat kernel corresponding to the 
Dirichlet Laplacian, we obtain the desired small time Varadahn's
asymptotics. 

There is a large class of rough metrics
for which we know that the heat kernel exists
and for which Varadhan's formula holds. 
Take $h$ smooth and let $\psi:M \to M$
be a Lipeomorphism (that is, a locally bi-Lipschitz map).
Define $g = \pullb{\psi}h$, then, $g$ 
also induces a length structure with 
distance given by $d_g(x,y) = d_h(\psi(x), \psi(y))$.
Moreover, a calculation gives
that $\hk^{g}_t(x,y) = \hk^{h}_t(\psi(x), \psi(y))$
(or more generally for $\hk^{g,\cW}_t(x,y)$). 
On combining the fact that $\hk^h_t$ satisfies
Varadhan's formula, it is easy to see that
so does $\hk^{g}_t$. In fact, we 
note that $\hk^g`_t \in \Ck{0,1}(M \times M)$,
which is of higher regularity than we we
obtain for general rough metrics.

In what follows, we adapt the key idea in 
the proof of Theorem 5.2.1 in \cite{Davies}
to our setting. Due to the more general 
nature of our problem, we are forced to 
establish a number of a priori facts which 
are more or less immediate in the smooth case.
What we present here was initially adapted for the
compact case in \cite{BRough}, but further analysis
has shown that we can make it work in the general.

With this terminology, we present the fundamental estimate we
require is the following \emph{weak Harnack-type inequality}.
\begin{itemize}
\item[] At each $x \in M$ and $t > 0$, there exists a precompact
open set $U_x$, a $\delta_t \geq 0$ and a constant $C = C(t, U_x)  > 0$ such that
\begin{equation}
\tag{H}
\label{eq:Harnack}
\esssup_{y \in U_x} u(y,t) 
	\leq \essinf_{y \in U_x} u(y, t + \delta_t)
\end{equation}
\end{itemize}

In the compact case, even for a
rough metric, such an estimate can be
obtained with $C(t,U_x)$ precisely quantified
in terms of the curvature of a nearby smooth metric.
However, the key observation to pass from the compact analysis
to the general setting we present here was to note that
the estimates we require are purely local. In 
what is to follow, we will see that the constant can be
crude, it simply allows us to assert the existence and regularity
of $\hk^{g,\cW}_t$, but the finer properties can still 
be extracted by operator theory, in particular, from the 
fact that $t \mapsto e^{-t\Delta_{g,\cW}}$ is a semigroup.

\begin{prop}
\label{prop:MainRed}
Suppose that \eqref{eq:Harnack} holds. Then, the heat
kernel $\hk^{g,\cW}_{\mdot}: \R_{+} \times M \times M \to \R$
exists. Moreover, $\hk^{g,\cW}_t(x,y) > 0$ for
every $t > 0$ and almost every $x,\ y \in M$. 
\end{prop} 
\begin{proof}
We outline the steps of the construction of the heat kernel
noting that the pointwise expressions from here on should be
understood in an almost-everywhere sense.
\begin{enumerate}[(i)]
\item For $u \in \Ck{\infty}$, it is readily verified that 
	$\modulus{ \nabla \modulus{u}} \leq \modulus{ \nabla u}.$
	In particular, this means that 
	for $u \in \Ck{\infty} \intersect \cW$
	$\norm{\nabla \modulus{u}} = \norm{\nabla u},$
	and therefore, whenever $u \in \cW$
	we have that $\modulus{u} \in \cW$ 
	with this estimate holding.

\item 	By construction $\dom(\sqrt{\Delta_{g, \cW}}) = \cW$
	and $\norm{\sqrt{\Delta_{g,\cW}} f} = \norm{\nabla f}$
	for all $f \in \cW$ and therefore, 
	$\norm{\sqrt{\Delta_{g, \cW}} \modulus{u}} 
		\leq \norm{\sqrt{\Delta_{g, \cW}} u}$. 
	By the Buerling-Deny condition (c.f.  Corollary 2.18(2) in  \cite{El-Maati}), 
	this yields that for $\Lp{2}(M) \ni f \geq 0$
	we have that  $e^{-t \Delta_{g,\cW}} f \geq 0$. That is, the semigroup 
	$e^{-t \Delta_{g,\cW}}$ is (weakly) positive preserving.

\item Now, left $f \in \Lp{2}(M)$, and write
	$f = f_+ - f_-$, where $f_{\pm} = \max\set{0,\pm f}$.
	It is clear that $f_{\pm} \in \Lp{2}(M)$
	and that $\modulus{f} = f_+ + f_-$.
	By the fact that we have shown $e^{-t\Delta_{g,\cW}}$ 
	is positive preserving, this means that
	for $u_{\pm} (x,t) = e^{-t\Delta_{g,\cW}} f_{\pm} \geq 0$	
	and we have that $u(x,t) = e^{-t \Delta_{g,\cW}} f = u_+(x,t) - u_-(x,t)$.

\item  Since $u_{\pm}(x,t) \geq 0$ are positive solutions,
	using inequality \eqref{eq:Harnack}, we have a precompact $U_x$ 
	with 
	\begin{align*} 
	\modulus{e^{-t \Delta_{g,\cW}}f(x)}  &= \modulus{u(x,t)} = u_+(x,t) + u_-(x,t) \\
		&\leq C(t,U_x) (u_+(y,t+\delta_t) + u_-(y,t+\delta_t)) \\
		&= C(t,U_x) \modulus{u(y,t + \delta_t)}
		= C(t,U_x)  \modulus{e^{-(t + \delta_t) \Delta_{g,\cW}}f(y)}
	\end{align*} 
	for almost-every $y \in U_x$.
	On integrating both sides over $U_x$ (which has $\omega_g(U_x) < \infty$
	by precompactness and the properties of the measure $\omega_g$) with respect
	to the variable $y$,
	we have that
	\begin{align*} 
	\modulus{e^{-t \Delta_{g,\cW}}f(x)} 
		&\leq \frac{C(t,U_x))}{\omega_g(U_x)} \int_{U_x} \modulus{e^{-(t + \delta_t) \Delta_{g,\cW}}f(y)}\ d\omega_g(y) \\
		&\leq \frac{C(t,U_x)}{\omega_g(U_x)^{\frac{1}{2}}} \norm{e^{-(t + \delta_t) \Delta_{g,\cW}f}},
	\end{align*}
	where the second inequality follows from the Cauchy-Schwartz
	inequality and since $\norm{\cdot}_{\Lp{2}(U_x)} \leq \norm{\cdot}_{\Lp{2}(M)}$.

\item By the self-adjointness of $\Delta_{g,\cW}$, via functional calculus 
	we obtain that $\norm{e^{-s\Delta_{g,\cW}}f} \leq \norm{f}$
	uniformly in $s$  and therefore, we obtain that for each fixed \((t, x)\),
	$$\modulus{e^{-t \Delta_{g,\cW}}f(x)} \leq 
		\frac{C(t,U_x)}{\omega_g(U_x)^{\frac{1}{2}}} \norm{f}.$$
	This exactly says that $f \mapsto (e^{-t\Delta_{g,\cW}}f)(x) \in \adj{\Lp{2}(M)}$
	for every $f \in \Lp{2}(M)$ and therefore, by the Riesz Representation theorem,
	we obtain, for each fixed \((t, x)\), an $a_{t,x} \in \Lp{2}(M)$ such that
	$$ e^{-t \Delta_{g,\cW}}f(x) = \inprod{a_{t,x},f} = \int_{M} a_{t,x}(y)f(y)\ d\omega_g(y)$$
        for every \(f \in \Lp{2}\). Because \(t \mapsto e^{-\Delta t} f\) is a continuous semi group mapping \(\Lp{2} \to \Lp{2}\) we have that \(x \mapsto a_{t,x}\) is measurable and hence \((t, x) \mapsto a_{t,x}\) is measurable.

\item We now may define the symmetric function,
  $$\hk^{g,\cW}_t(x,y) := \inprod{a_{\frac{t}{2}, x}, a_{\frac{t}{2}, y}}$$
        We claim that \(\hk^{g,\cW}\) is a heat kernel: we use the by the semigroup property and self adjointness of \(e^{-t\Delta_{g,\cW}}\). For clarity, let us write \(\inprod{f(y), g(y)}\) to denote that the integration is over the \(y\) variable. Then we have
	\[
        \begin{split}
        (e^{-t \Delta_{g,\cW}}f) (x) &= e^{-\frac{t}{2} \Delta_{g,\cW}} (e^{-\frac{t}{2} \Delta_{g,\cW}} f) (x) = \inprod{a_{t,x} (y), e^{-\frac{t}{2} \Delta_{g,\cW}} f (y)} \\
        &= \inprod{e^{-\frac{t}{2} \Delta_{g,\cW}} a_{t,x} (y), f (y)} = \inprod{\inprod{a_{t,y}(z), a_{t,x}(z)}, f(y)} \\
        &= \inprod{\hk^{g,\cW}_t(x,y), f(y)}.
        \end{split}
        \]
        Next, since $e^{-t \Delta_{g,\cW}}$	is positive preserving, $\hk_t^{g,\cW}$ is real-valued. Moreover, since $\lim_{t\to 0} e^{-t\Delta_{g,\cW}}f = f$ in $\Lp{2}$, we have that $\lim_{t \to 0} \hk^{g,\cW}_t(\mdot,y) \to  \delta(y)$ in the sense of distributions.

        To finish showing that $\hk^{g,\cW}_t$ is indeed the heat kernel, we verify measurability in \((x, y, t)\). Continuity of the semigroup \(e^{-t\Delta}\) implies the map \(t \mapsto e^{-t \Delta} f\) is continuous and hence for each fixed \(x\),
        \[
        t \mapsto e^{-t\Delta_{g,\cW}} f (x) = \inprod{a_{t,x}, f}
        \]
        is continuous. Composing with the diagonal map on \(t\), we see that for fixed \(x,y\), choosing \(f = a_{t,y}\) we have
        \[
        t \mapsto \rho_t(x, y) = \inprod{a_{t,x}, a_{t,y}}
        \]
        is continuous.

        Next, by self-adjointness, we have that for each \(t\), $e^{-t \Delta_{g,\cW}}$
	is a bounded self-adjoint operator on \(\Lp{2}\) so that for any \(f \in \Lp{2}\),
        \[
        x \mapsto (e^{-t \Delta_{g,\cW}} f) (x) = \inprod{a_{t,x}, f}
        \]
        is in \(\Lp{2}\). Hence \(\rho_t(x, y)\) is measurable separately in both \(x\) and \(y\) by choosing \(f = a_{t,y}\) for measurability in \(x\) and using the symmetry of \(\rho_t\) for measurability in \(y\). Now we want to conclude joint measurablity in \(x,y\).

        Thus \(\rho\) is continuous in \(t\) and jointly measurable in \(x, y\), hence a Carath\'eodory function, hence jointly measurable in \(t, x, y\) by \cite[4.51 Lemma]{aliprantis06}

\item Lastly, we show that $\hk^{g,\cW}_t(x,y) > 0$  almost-everywhere.
	We reason by contradiction so assume that there
	is a time $t > 0$ and a measurable set $A \subset M$ with $\omega_g(Z) > 0$
	such that $\hk^{g,\cW}_t(x,y) = 0$ for $x \in A$.
	Since $M = \union_{n} \Omega_n$ with each 
	$\Omega_n$ precompact, we can find an integer
	$k$ for which $B = A \intersect \union_{n=1}^k \Omega_k$ 
	satisfies $0 < \omega_g(B) < \infty$. Then,
	we have that $\ind{B} \in \Lp{2}(M)$ and 
	on using the self-adjointness of $\Delta_{g,\cW}$,
	we note
	\begin{multline*}  
	\norm{e^{-\frac{t}{2} \Delta_{g,\cW}}\ind{B}}^2 
		 = \inprod{e^{-t \Delta_{g,\cW}} \ind{B},\ind{B}} \\
		= \int_{B} \hk^{g,\cW}_t(x,y)\ind{B}(y)\ d\omega_g(y) + 
			\int_{M \setminus B} \hk^{g,\cW}_t(x,y)\ind{B}(y)\ d\omega_g(y).
	\end{multline*}
	Now, note that the first integral vanishes
	since we assume $\hk^{g,\cW}_t$ is $0$ on $B$
	and the second since $\ind{B} = 0$ on $M \setminus B$.
	Therefore, we find that $\norm{e^{-\frac{t}{2} \Delta_{g,\cW} \ind{B}}} = 0$.
	This, along with the fact that we've shown $\hk^{g,\cW}_s(x,y) \geq 0$ 
	for each $s > 0$ yields that $\hk^{g,\cW}_{\frac{t}{2}}(x,y) = 0$ for 
	almost every $x,\ y \in B$, and on 
	iterating this procedure, we obtain that
	$\norm{e^{-\frac{t}{2^m} \Delta_{g,\cW} \ind{B}}} = 0$.
	Thus, we have that $\lim_{s\to 0} e^{-s \Delta_{g,\cW}} \ind{B} = 0$, 
	but by the non-negative self-adjointness of
	$\Delta_{g,\cW}$, we know that $\lim_{s \to 0} e^{-t \Delta_{g,\cW}} u = u$
	for any $u \in \Lp{2}(M)$.  This is a contradiction
	which shows that $\hk^{g,\cW}_t(x,y) > 0$ almost everywhere.
\end{enumerate} 
\end{proof}

\begin{rem}
We note that the Harnack-type estimate that we assume is very 
weak, i.e., it is not defined on cylinders or even 
parabolic cylinders. The proof shows that the existence 
of the heat kernel only requires such an estimate. 
As we shall see in the next section, a stronger
estimate is required for regularity of solutions. 
\end{rem}

%Lastly, in this section, we address the question of 
%the positivity of the heat kernel. For that, 
%we use the language of the convergence 
%increasing self-adjoint non-negative operators.
%We take inspiration for this proof
%from the proof of Theorem 2.1.6 in \cite{Davies}
%by Davies. 
%
%\begin{prop}
%\label{prop:hkpos}
%The heat kernel $\hk^{g,\cW}_t(x,y) > 0$ for almost every 
%$x,\ y \in M$.
%\end{prop}
%\begin{proof}
%Let $\Omega$ be a precompact open set in $M$ with $\partial \Omega$
%smooth. Let $\Delta_{g,\cW,k} = \Delta_{g,\cW} + k \ind{M \setminus \Omega}$
%and let $\sE_{g,\cW,k}$ be it associated sesquilinear
%form, given by 
%$$\dom(\sE_{g,\cW,k}) = \dom(\sqrt{\Delta_{g,\cW,k}}) 
%	= \dom(\sqrt{\Delta_{g,\cW}}) = \cW,$$
%and $\sE_{g,\cW,k}(u,v) = \inprod{\sqrt{\Delta_{g,\cW,k}} u, \sqrt{\Delta_{g,\cW,k}}v}$. 
%
%Recall that the limiting form exists by Theorem 1.2.2 
%in \cite{Davies} and is given by: 
%$u \in \dom(\sE_{g,\cW,\infty})$ if and only if
%$\sE_{g,\cW,\infty}(u,u) = \lim_{k\to\infty} \sE_{g,\cW,k}(u,u) < \infty$. 
%To compute this domain, take $u \in \Ck{\infty}(M) \intersect W$
%and 
%\begin{multline*} 
%\sE_{g,\cW,k}(u,u) = \norm{\sqrt{\Delta_{g,\cW,k}}u}^2
%	= \inprod{\Delta_{g,\cW,k}u,u} \\
%	= \norm{\nabla u^2} + k \inprod{\ind{M \setminus \Omega} u, u}
%	= \norm{\nabla u^2} + k \norm{\ind{M \setminus \Omega} u}^2.
%\end{multline*}
%Now, by the characterisation of $\dom(\sE_{g,\cW,\infty})$
%we see that we must have $u = 0$ on $M \setminus \Omega$,
%and since $\cW \subset \SobH{1}(M)$, we have that
%$u\rest{\Omega} \in \SobH[0]{1}(\Omega)$. 
%Since we've established that $e^{-t{\Delta_{g,\cW}}}$
%is positive preserving, we similarly have that 
%$e^{-t {\Delta_{g,\cW,k}}}$ is positive preserving
%by repeating the argument in Proposition \ref{prop:MainRed}
%noting that 
%$\norm{\sqrt{\Delta_{g,\cW,k}}u}^2 
%	= \norm{\nabla u^2} + k \norm{\ind{M \setminus \Omega} u}^2$
%and hence, for $f \geq 0$ with $f \in \Lp{2}(M)$,
%$ e^{-t{\Delta_{g,\cW,k}}}f \leq e^{-t{\Delta_{g,\cW}}}f.$
%Taking limits, we obtain that 
%$$e^{-t{\Delta_{g,\SobH[0]{1}(\Omega)}}}f
%	\leq e^{-t{\Delta_{g,\cW}}}f,$$
%where the left hand expression is extended
%to the whole of $M$ by $0$ 
%and $\Delta_{g,\SobH[0]{1}(\Omega)}$ is the Dirichlet
%Laplacian inside $\Omega$.
%\note{We need to ensure that this limit exists 
%for the exponential, find a citation or justify 
%why we can do this. Davies does a similar thing in Theorem 2.1.6}
%
%Now, since we assumed that $\Omega$ is precompact,
%there exists a smooth metric $h$ such that
%$g(u,v) = h(Au,v)$ with $A \in \Lp{\infty}(T^{1,1}M, h)$
%and $d\omega_g = \sqrt{\det A} d\omega_h$.
%Therefore, we have that
%$$ \norm{\nabla  u}_{\SobH[0]{1}(\Omega,h)} 
%	\lesssim \norm{\nabla u}_{\SobH[0]{1}(\Omega,g)}
%	\lesssim \norm{\nabla u}_{\SobH[0]{1}(\Omega,h)},$$
%and so we have 
%\begin{multline*}
%\set{0} = \nul(\Delta_{h, \SobH[0]{1}(\Omega,h)}) 
%	= \nul\cbrac{\sqrt{\Delta_{h, \SobH[0]{1}(\Omega,h)}}} \\
%	= \nul\cbrac{\sqrt{\Delta_{g, \SobH[0]{1}(\Omega,g)}}}
%	= \nul(\Delta_{g, \SobH[0]{1}(\Omega,g)}).
%\end{multline*}
%Moreover, we have that 
%the first eigenvalues of the Laplacians satisfy
%$$0 < \lambda_1(\Delta_{h,\SobH[0]{1}(\Omega,h)}) \leq 
%	C' \lambda_1(\Delta_{g, \SobH[0]{1}(\Omega,g)})$$
%where the constant $C' > 0$ depends on $A$
%and hence, we have that $e^{-t\Delta_{g,\SobH[0]{1}(\Omega,h)}}\ind{\Omega} > 0$.
%Since we know that $e^{-t\Delta_{g,\SobH[0]{1}(\Omega,h)}}$
%is positive preserving, this proves
%the claim.
%\note{Check through this argument, make sure it holds water.}
%\end{proof}  

\section{The Harnack inequality and regularity}
\label{sec:harnack}


In this section, we demonstrate that a
 stronger form of the  Harnack 
estimate than \eqref{eq:Harnack} holds for the rough 
metrics we consider. The estimate \eqref{eq:Harnack} 
will then be a consequence of this estimate.
To describe this estimate, fix a collection of 
locally comparable charts $\psi_x:V_x \to \R^n$ denote
for each $x \in M$ such that $\psi_x(V_x) = B_{r_x}$,
where $B_{r_x}$ is a ball of radius $r_x > 0$. 
Then, let
$\delta_x(\cdot, \cdot) = \pullb{\psi_x}\delta(\cdot, \cdot)_{\R^n}$
denote the pullback metric with $\Leb_x = \pullb{\psi_x}\Leb$
and $d_x(y,y') = \modulus{\psi_x(y') - \psi_x(y)}_{\R^n}$.
Recall that there is a $C_x \geq $
with $C_x^{-1}  \modulus{u}_{\delta_x} \leq \modulus{u}_g \leq C_x \modulus{u}_{\delta_x}$
almost-everywhere in $V_x$.

Fix $0 < \kappa < \tau < \infty$ and an $0 < \epsilon < \kappa$,
and for $x \in M$ and $t \in (\kappa, \tau)$, define
\begin{equation}
\label{eq:paradef}
\begin{split} 
Q^-_{(x,t)}(\kappa, \tau, \epsilon) &= \set{(y,s) \in V_x \times (\kappa,\tau): s \in \cbrac{t - \frac{3}{4}\epsilon^2, t - \frac{1}{4} \epsilon^2},\ 
	d_x(x,y) < \frac{1}{2} \epsilon} \\
Q^+_{(x,t)}(\kappa, \tau, \epsilon) &= \set{(y,s) \in V_x \times (\kappa,\tau): s \in \cbrac{t + \frac{3}{4}\epsilon^2, t + \epsilon^2},\ 
	d_x(x,y) < \frac{1}{2} \epsilon}
\end{split}
\end{equation}

The Harnack inequality can be deduced relatively easily from the Harnack inequality stated in \cite{SC}.

\begin{thm}
\label{thm:Harnack}
Let $u(x,t) \geq 0$ be a
solution to the $\Delta_{g,\cW}$ heat equation 
that is non-negative in $(\kappa, \tau)$. 
Then, there exists $\gamma = \gamma(n, C_x, \kappa, \tau) > 0$ such that 
$$ \sup_{(y,s) \in Q^-_{(x,t)}(\kappa, \tau,\epsilon)} u(y, s) 
	\leq \gamma \inf_{(y,s) \in Q^+_{(x,t)}(\kappa,\tau,\epsilon)} u(y,s)$$
for all $\epsilon < \min\set{ \sqrt{t - \kappa}, \sqrt{\tau - t}, r_x}$.
\end{thm}

\begin{proof}
First of all, Lemma \ref{eq:soln1} below shows that a solution $u$ of the $\Delta_{g,\cW}$ heat equation is a weak solution, hence Moser's parabolic Harnack inequality \cite{MR0159139,MR0288405} is expect to apply. The only reason we cannot immediately apply Moser's result is because of the factor $a_x$. But this factor is time independent, measureable and $a_x > 0$ almost everywhere, which is precisely the situation described in \cite[Section 4]{SC}. Then we conclude Theorem 5.3 from \cite{CS} applies which is precisely our Hanack inequality stated in the theorem.
\end{proof}

\begin{rem}
The astute reader might object that the result of \cite{SC} applies only to rough metrics that are globally comparable to a complete, smooth metric of bounded below Ricci curvature. However, the estimate is entirely local and it is only through the constants that the curvature bounds and global comparability enter. Thus in our situation, we do not obtain uniform, global constants (and indeed do not expect them at this level of generality!), but such control is not necessary for our applications.

To make the argument concrete, for any relatively compact coordinate chart $U \subset \R^n$ on which the rough metric $g$ is comparably to a smooth metric $g_0$ with bounded below curvature, and any open subset $V$ with $\bar{V} \subset U$, let $\rho$ be a smooth function supported in $U$ with $\rho \equiv 1$ on $V$ and let
\[
h = \rho g + (1-\rho) \delta
\]
where $\delta$ is the Eulidean metric on $\R^n$. Then $h$ is a rough metric, globally comparable to the complete, smooth metric $h_0$ fo bounded below curvature defined by
\[
h_0 = \rho g_0 + (1-\rho) \delta.
\]

Then $h$ satisfies all the hypotheses of \cite{SC} and we may immediately apply Theorem 5.3 to obtain the Harnack inequality for $h$. Then our local Harnack inequality for $g$ applies by restricting the Harnack inequality for $h$ to $V$.
\end{rem}

In the compact setting, such an inequality 
is immediate from the work of \cite{SC}. There, 
he proves such estimates for general operators
$L = -a \divv A \nabla$, where $a \in \Lp{\infty}(M)$
and $A \in \Lp{\infty}(T^{1,1}M)$ and symmetric
for smooth metric $h$ with a uniform lower bound
on Ricci curvature.
The key to note is that a rough metric in the 
compact setting is globally comparable to a smooth one, 
i.e., there exists a global constant $C \geq 1$ 
and a 
such that
$$ C^{-1} \modulus{u}_{h} \leq \modulus{u}_g \leq C \modulus{u}_{h}$$
for $u \in T_x M$ for almost-every $x \in M$.
By the virtue of compactness, it is immediate
that the Ricci curvature of $h$ is bounded below
by a uniform constant. 
In fact, this procedure also works 
for rough metrics $g$ which 
are uniformly close to some metric $h$ with 
lower bound on Ricci curvature in the sense
we have just written.

We emphasise that the goal in \cite{SC}
is to quantify the constants $C(t,U_x)$
appearing in Theorem \ref{thm:Harnack}. In what we present here, we do not have
the ability to control these constants. However, as
Proposition \ref{prop:MainRed} illustrates, this is not necessary 
in order to obtain the existence of the heat kernel.
Quantifying such estimates is, however, still 
extremely important and useful when it can be done.
For instance, Proposition \ref{prop:MainRed} 
only asserts that $\hk^{g}_t \in \Ck{0}(M \times M)$
but if $g$ was uniformly close to a $h$
with a lower bound on its Ricci curvature, then
there would exist an $\alpha$ depending on this bound
with $\hk^{g}_t \in \Ck{\alpha}(M \times M)$.

The main way in which we will proceed is to use the
results in \cite{CS}. There, they analyse
degenerate equations via the methods of harmonic analysis.

Throughout the remainder of this section,
we assume that $u(\cdot, \cdot): M \times \R_+$ 
is a solution to the $\Delta^{g,\cW}$ heat equation.
Moreover, let $g(u,v) = \delta_x(A_x u,v)$
and $a_x = \sqrt{\det A_x}$ so that
$\omega_x(y) = a_x(y)d\Leb_x(y)$, and note
that:
\begin{equation}
\label{eq:constbd}
\begin{split}
&C_x^{-2} \modulus{u}_{\delta_x} \leq \delta_x(A_x u, u) \leq C_x^2 \modulus{u}_{\delta_x} \\
&C_x^{-\frac{n}{2}} \leq a_x \leq C_x^{\frac{n}{2}}.
\end{split}
\end{equation}
See Section 3.3 in \cite{BRough} for details. 

\begin{lemma}
\label{eq:soln1}
The solution $u$ satisfies the following: for all $v \in \SobH[0]{1}(V_x,g)$, 
	\begin{equation} 
	\label{eq:testfn1}	 
	\inprod{a_x \partial_t u, v}_{\Lp{2}(V_x, \delta_x)} 
		= \inprod{ B_x \nabla u, \nabla v}_{\Lp{2}(V_x, \delta_x)},
	\end{equation}
where $B_x = a_x A_x$. Moreover,
\begin{equation}
\label{eq:coeff}
C_x^{-2} a_x \modulus{\xi}_{\delta_x}^2 \leq \delta_x(B_x \xi, \xi) 
	\leq C_x^2 a_x \modulus{\xi}_{\delta_x}^2
\end{equation} 
for every $\xi \in T_xM$ and almost everywhere in $V_x$. 
\end{lemma}
\begin{proof}
Since the solution $u \in \dom(\Delta_{g,\cW}) \subset \Lp{2}(M)$, we
note that in particular, for any $v \in \Ck[c]{\infty}(M)$, 
$\inprod{\partial_t u, v} = \inprod{\nabla u, \nabla v}$.
Choosing $\spt v \subset V_x$, we note that $\inprod{\cdot, v} = \inprod{\cdot, v}_{\Lp{2}(V_x,g)}$
and hence,
$$\inprod{\partial_t u, v} = \int_{V_x} \partial_t u\conj{v}\ d\omega_g 
	= \int_{V_x} a_x \partial_t  u \conj{v}\ d\Leb_x
	= \inprod{\partial_t (a_x u), v}_{\Lp{2}(U_x, \delta_x)},$$
where the last equality follows from the fact that 
$a_x(y) \partial_t u(y,t) = \partial_t (a_x(y)u(y,t).$
Similarly,
$$\inprod{\nabla u, \nabla v} 
	= \int_{V_x} g(\nabla u, \nabla v)\ d\omega_g
	= \int_{V_x} \delta_x(a_x A_x \nabla u, \nabla v)\ d\Leb_x
	= \inprod{B_x \nabla u, \nabla v}_{\Lp{2}(U_x, \delta_x)}.$$
The estimate on $B_x$ follows immediately from
\eqref{eq:constbd}.
\end{proof} 

For $0 < \kappa < \tau < \infty$ fixed, let
define $u_\kappa(x,t) = u(x,t+\kappa)$. Then we note the following. 
\begin{lemma}
\label{lem:shiftsol}
We have that: 
\begin{enumerate}[(i)] 
\item $u_\kappa$ is a solution to the $\Delta_{g,\cW}$ heat equation, 
\item there is a constant $C_\kappa \geq 0$
	which depends on $\kappa$ 
	such that $\norm{\nabla u_\kappa} \leq C_\kappa$.
\end{enumerate} 
\end{lemma}
\begin{proof}
Note that by definition, and using the semigroup property, 
$$u_\kappa(x,t) = e^{-(t + \kappa)\Delta_{g,\cW}} u_0 
	=e^{-t \Delta_{g,\cW}}e^{-\kappa\Delta_{g,\cW}}u_0
	=e^{-t \Delta_{g,\cW}}u(x,\kappa).$$ 
Therefore, it is immediate that $u_\kappa$ is a solution
to the heat equation. 

To see the bound, we compute: 
\begin{multline*} 
\norm{ \nabla u_\kappa(\cdot, t)} 
	= \norm{ \sqrt{\Delta_{g,\cW}} u_\kappa(\cdot, t)} 
	= \norm{ \sqrt{\Delta_{g,\cW}} e^{-t\Delta_{g,\cW}} e^{-\kappa \Delta_{g,\cW}}u_0} \\
	= \norm{ e^{-t \Delta_{g,\cW}} \sqrt{ \Delta_{g,\cW}} e^{-\kappa \Delta_{g,\cW}}u_0}
	\leq \norm{\sqrt{ \Delta_{g,\cW}} e^{-\kappa \Delta_{g,\cW}}u_0},
\end{multline*}
where the penultimate equality follows from the fact that
$\ran(e^{-\kappa \Delta_{g,\cW}}) \subset \dom(\Delta_{g,\cW}^\alpha)$
for all $\alpha > 0$ and via functional calculus.
The proof is complete on setting the constant 
$C(\kappa) = \norm{\sqrt{ \Delta_{g,\cW}} e^{-\kappa \Delta_{g,\cW}}u_0}$.
\end{proof}


As in \cite{CS}, for $T > 0$, define 
$$ W(T) = \set{ w \in \Lp{2}( (0,T); \SobH[0]{1}(V_x,g): \partial_t w \in \Lp{2}((0,T); \Lp{2}(V_x, g)},$$
and let $W_0(T) = \set{ w \in W: w(0) = w(T) = 0}.$

\begin{lemma}
The solution $u_\kappa \in \Lp{2}((0, \tau - \kappa); \SobH{1}(V_x, g))$
and is a weak solution in the following sense:
\begin{equation}
\label{eq:testfn2} 
\int_{0}^{\tau - \kappa} \inprod{a_x u_\kappa(t), \partial_t w(t)}_{\Lp{2}(V_x,\delta_x)}\ dt 
		= \int_{0}^{\tau - \kappa } \inprod{B_x \nabla u_\kappa(t), \nabla w(t)}_{\Lp{2}(V_x, \delta_x)}\ dt
\end{equation}
for all $w \in W_0(\tau - \kappa)$.
\end{lemma}
\begin{proof}
Fix $w \in W_0$ and from \eqref{eq:soln1}, we have that
$$\inprod{a_x \partial_t u_\kappa (t), w(t)}_{\Lp{2}(V_x, \delta_x)} 
		= \inprod{ B_x \nabla u_\kappa(t), \nabla v(t)}_{\Lp{2}(V_x, \delta_x)}$$
for every $t \in (0, \tau - \kappa)$.
A calculation similar to that in Lemma \ref{lem:shiftsol} 
yields that $\norm{ \partial_t u_\kappa} \leq C_\kappa'$
for all $t \in (0, \tau - \kappa)$
on noting that $\partial_t u_\kappa = \Delta_{g,\cW} u_\kappa$.
This, along with the bound in Lemma \ref{lem:shiftsol}
shows that  $u_\kappa \in \Lp{2}((0, \tau - \kappa); \SobH{1}(V_x, g))$
and that $\partial_t u_\kappa \in \Lp{2}((0,\tau - \kappa); \Lp{2}(V_x, g))$. 

Moreover, note that $W(\tau- \kappa) \subset \SobH{1}((0,\tau-\kappa); \Lp{2}(V_x,g))$
and therefore $\Ck{\infty}((0,\tau-\kappa); \Lp{2}(V_x,g) \intersect W(\tau - \kappa)$
is dense in $W$ in the Sobolev norm. Therefore on 
choosing such a $w$, as well as the fact that $w(0) = w(\tau - \kappa) = 0$, 
by the fundamental theorem of calculus in the Banach 
valued setting (c.f. \cite{}), we obtain that
$$\int_{0}^{\tau - \kappa} \inprod{ \partial_t(a_x u_\kappa(t)), w(t)}_{\Lp{2}(V_x,g)}\ dt
	= \int_0^{\tau - \kappa} \inprod{a_x u_\kappa(t), \partial_t w(t)}_{\Lp{2}(V_x, g)}\ dt.$$
Also, the integral on the left is equal to:
$$\int_{0}^{\tau - \kappa} \inprod{ \nabla u_\kappa(t), \nabla w(t)}\ dt$$
and by the aforementioned density of
 $\Ck{\infty}((0,\tau-\kappa); \Lp{2}(V_x,g) \intersect W(\tau - \kappa)$ 
in $W(\tau - \kappa)$ along with the fact that $\nabla u_\kappa \in \Lp{2}((0, \tau - \kappa); \Lp{2}(V_x,g))$,
the proof is complete.
\end{proof} 

With these three lemmas in hand, we prove the main theorem.

\begin{proof}[Proof of Theorem \ref{thm:Harnack}]
Let $\epsilon > 0$ be sufficiently small to 
be determined later. 
Fix $0 < \kappa < \tau < \infty$ and suppose that $u(x,t) \geq 0$ 
is a positive solution of
the $\Delta_{g,\cW}$ in $(\kappa,\tau)$. 
Then, as before, write $u_\kappa(x,t) = u(x,t+\kappa)$.

Let $D$ be any $n$-dimensional cube inside $\psi_x(V_x)$ then 
on writing $D_x = \psi_x^{1}(D)$, we have  
$$ \int_{D_x} a_x(y)\ d\Leb_x(y) \leq C_x^{\frac{n}{2}} \Leb_x(C),
\ \text{and}\ 
\int_{D_x} \frac{1}{a_x(y)}\ d\Leb_x(y) \leq C_x^{\frac{n}{2}}.$$
Therefore, our density $a_x$ satisfies the so called $A_2$ condition:
$$c_0 := \sup_{D_x} \cbrac{ \frac{1}{\Leb_x(D_x)} \int_{D_x} a_x(y)\ d\Leb_x(y)}
\cbrac{ \frac{1}{\Leb_x(D_x)} \int_{D_x} \frac{1}{a_x(y)}\ d\Leb_x(y)} 
	\leq C_x^n.$$
Combining this with the \eqref{eq:coeff} as
well as Lemma \eqref{eq:testfn2} shows that $u_\kappa$
satisfies the hypotheses of Theorem 2.1 in \cite{CS} and
therefore, we obtain a $\gamma = \gamma(C_x, n, \kappa, \tau) > 0$
such that 
\begin{equation} 
\label{eq:harnack2} 
\sup_{(y,s) \in Q_{(x,t-\kappa)}^-(0, \tau - \kappa, \epsilon)} u_\kappa(y,s)
		\leq \gamma \inf_{(y,s) \in Q^+_{(x,t-\kappa)}(0, \tau - \kappa, \epsilon)} u_\kappa(y,s).
\end{equation}
Note now that setting $s' = s + \kappa$, we have that
$(y, s' - \kappa) \in Q^{\pm}_{(x,t- \kappa)}(0, \tau - \kappa, \epsilon)$
if and only if $(y, s') \in Q^{\pm}(x,t)(\kappa, \tau, \epsilon)$.
That is, \eqref{eq:harnack2} is equivalent to the statement 
in the conclusion of the theorem and hence, this concludes
the proof.

Now, to compute a bound for $\epsilon$, note that
we want to ensure 
\begin{multline*}\set{(y,s) \in V_x \times (0, \infty): |y - s| < \epsilon, |t - s| < \epsilon^2} \\
\subset \set{(y,s) \in V_x \times (\kappa, \tau): |y - s| < \epsilon, |t - s| < \epsilon^2}
\end{multline*} 
we note that we require $\kappa < t - \frac{3}{4} \epsilon^2$,
$t + \epsilon^2 < \tau$ and $\epsilon < r_x$.
Rearranging this gives the range of $\epsilon$
in the conclusion.
\end{proof} 

\section{Regularity of solutions}

An important consequence of Harnack estimates for weak 
solutions is that they yield a priori regularity estimates
for those solutions. It is classical fact how these estimates
yield regularity results. For the benefit of the reader, 
we give the following brief outline of how to obtain
regularity from the estimates in Theorem \ref{thm:Harnack}.
We follow the argument of Theorem 6.28 in 
\cite{Lieberman} by Lieberman.

\begin{prop}
Let $u$ be a solution to the $\Delta_{g,\cW}$
heat equation (not necessarily positive).
Fix $x \in M$ and $0 < t_1 < t_2 < \infty$.
Then, there exists an open set $U_x \subset V_x$ 
with $x \in U_x$
such that 
$$ \modulus{u(y,s) - u(y',s)} \leq C(n, C_x, t_1, t_2) d_x(y, y')^\alpha,$$
where 
$$ \alpha = \log_{\frac{1}{4}}\cbrac{1 - \frac{1}{\gamma}}$$
for every $s \in [t_1, t_2]$.
\end{prop}
\begin{proof}
Let 
$\kappa = \frac{t_1}{2},\ \tau = \frac{3t_2}{2},\ R_0 = \frac{1}{4} \min\set{t_1, r_x},$ fix $r < \frac{R_0}{4}$.
Define, 
\begin{align*}
&M_4 = \sup_{(y,s) \in Q^{-}_{(x,t)}(\kappa, \tau, 4r)} u(y,s) &&m_4 = \inf_{(y,s) \in Q^{-}_{(x,t)}(\kappa, \tau, 4r)} u(y,s) \\
&M_1 = \sup_{(y,s) \in Q^{-}_{(x,t)}(\kappa, \tau, r)} u(y,s) &&m_1 = \inf_{(y,s) \in Q^{-}_{(x,t)}(\kappa, \tau, r)} u(y,s), 
\end{align*} 
and note that $M_j - u$ and $u - m_j$ for $j = 1, 4$ are non-negative
solutions to the $\Delta_{g,\cW}$ heat equation.
By the choice of $R_0$,
we always have that $r < \min\set{ \sqrt{t - \kappa}, \sqrt{\tau - t}, r_x}$
for every $t \in [t_1, t_2]$. 
So, fix such a $t \in [t_1, t_2]$ we invoke Theorem \ref{thm:Harnack} and integrate,
\begin{multline*}
\iint_{Q^-_{(x,t)}(\kappa,\tau,r)} (M_4 - u)\ d\Leb_x dt 
	\leq \gamma \iint_{Q^-_{(x,t)}(\kappa,\tau,r)} \inf_{Q^+_{(x,t)}(\kappa, \tau, r)} (M_4 - u)\ d\Leb_x ds \\
	\leq \gamma (M_4 - M_1) \int_{t- \frac{3}{4}r^2}^{t - \frac{1}{4}r^2} \int_{\psi_x^{-1}(B(x,r))}\ d\Leb_x ds
	= \gamma w_n  \frac{1}{2}r^{2+n} (M_4 - M_1),$$
\end{multline*}
where $w_n$ is the constant for which $\Leb(B(x,r)) = w_n r^n$.
Note that the constant $\gamma$ is independent of $t$, and only 
dependent on $t_1$ and $t_2$ through our choice
of values for $\kappa$ and $\tau$. 
% Note:  $\inf (M_4 - u) = M_4 + \inf(-u) = M_4 - \sup{u} = M_4 - M_1$
By a similar calculation, 
$$
\iint_{Q^-_{(x,t)}(\kappa,\tau,r)} (u - m_4)\ d\Leb_x dt \leq \gamma w_n \frac{1}{2}r^{2+n} (m_1 - m_4),$$
and adding these two inequalities together, 
we get that
$$
\frac{1}{2}r^{2+n} w_n (M_4 - m_4) \leq \gamma w_n \frac{1}{2}r^{2+n} (M_4 - m_4 +m_1 - M_1).$$
Rearranging, we find that 
$$
\osc_{Q^{-}_{(x,t)}(\kappa, \tau, r)} u \leq \cbrac{1 - \frac{1}{\gamma}} \osc_{Q^{-}_{(x,t)}(\kappa, \tau, 4r)} u.$$
We note that the constant $(1 - \gamma{-1}) < 1$
and therefore, it is of the right form to invoke the
standard iteration procedure given in Lemma 4.6 in \cite{Lieberman}. 
More specifically, on noting that
our oscillation estimate is of the form (4.15)'' in \cite{Lieberman},
we obtain the precise form for $\alpha$.

The passage from this to the Hölder estimate
we have noted in the conclusion is immediate. 
\end{proof}

\printbibliography
\end{document}
